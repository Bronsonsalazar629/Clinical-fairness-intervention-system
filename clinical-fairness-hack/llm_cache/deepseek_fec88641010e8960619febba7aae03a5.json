{
  "cache_key": "fec88641010e8960619febba7aae03a5",
  "prompt": "\nGenerate ONLY executable Python code for: Fairlearn (Equalized Odds)\n\nFunction signature: def apply_intervention(df: pd.DataFrame, sensitive_attr: str, outcome: str)\n- Use fairlearn or aif360 libraries\n- Include type hints and docstring\n- Return trained model object\n\nReturn ONLY Python code (no markdown, no explanations).\n",
  "response": "```python\nimport pandas as pd\nimport numpy as np\nfrom typing import Any\nfrom sklearn.linear_model import LogisticRegression\nfrom fairlearn.reductions import EqualizedOdds\nfrom fairlearn.reductions import GridSearch\n\ndef apply_intervention(df: pd.DataFrame, sensitive_attr: str, outcome: str) -> Any:\n    \"\"\"\n    Apply Equalized Odds fairness intervention using Fairlearn.\n    \n    Parameters\n    ----------\n    df : pd.DataFrame\n        Input dataframe containing features, sensitive attribute, and outcome\n    sensitive_attr : str\n        Name of the sensitive attribute column (e.g., 'gender', 'race')\n    outcome : str\n        Name of the binary outcome/target column\n        \n    Returns\n    -------\n    Any\n        Trained model object implementing Equalized Odds fairness constraint\n    \"\"\"\n    # Prepare features and labels\n    X = df.drop(columns=[sensitive_attr, outcome]).values\n    y = df[outcome].values\n    sensitive_features = df[sensitive_attr].values\n    \n    # Initialize base estimator\n    base_estimator = LogisticRegression(solver='liblinear', random_state=42)\n    \n    # Initialize Equalized Odds constraint\n    constraint = EqualizedOdds()\n    \n    # Perform grid search for optimal mitigation\n    mitigator = GridSearch(\n        estimator=base_estimator,\n        constraints=constraint,\n        grid_size=50,\n        grid_limit=2.0\n    )\n    \n    # Fit the mitigator\n    mitigator.fit(X, y, sensitive_features=sensitive_features)\n    \n    return mitigator\n```",
  "temperature": 0.2,
  "timestamp": "2026-01-07T22:02:59.843146"
}